text8: &text8
   dataset: text8
   data: data/text8

model: &model
   d_model: 512
   n_head: 8
   d_head: 64
   d_inner: 2000
   dropout: 0.1
   dropatt: 0.1
   pre_lnorm: false
   model_config: "[2, (8,), 2]"
   activation_function: gelu
   shuffle: true
   roll: true
   nw: 8
   fp16: true
#   ckpt: './output/epoch15_trainstep170000.pt'

boundaries: &boundaries
   boundaries_type: 'unigram'
   tokenizer_path: './tokenizer_data/spm/text8/spmunigram-5000.model'
   fixed_sf: 2
   spikes_left: 2
   temp: 0.5
   prior: 0.2

eval: &eval
   eval_interval: 5000
   eval_max_steps: 500
   eval_tgt_len: 500
   eval_total_len: 2000

optim: &optim
   optim: adam
   scheduler: cosine
   lr: 0.00025
   warmup_step: 4000
   clip: 0.25
   weight_decay: 0
   adam_b1: 0.9
   adam_b2: 0.999
   adam_eps: 1e-8

train: &train
   cuda: true
   max_step: 200000
   tgt_len: 2000
   batch_size: 4
   batch_chunk: 1
   log_interval: 100

default:
   train:
      <<: *text8
      <<: *model
      <<: *boundaries
      <<: *eval
      <<: *optim
      <<: *train
